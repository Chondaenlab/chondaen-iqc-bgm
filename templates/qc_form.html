{% extends "base.html" %}
{% block title %}บันทึกผล QC - ระบบบันทึก Chondaen IQC BGM Online{% endblock %}

{% block content %}
<h3 class="mb-3">บันทึกผล Chondaen IQC BGM Online</h3>

<form method="post" action="{{ url_for('qc_form') }}">

  <!-- แถวที่ 1: หน่วยงาน/เครื่อง + วันที่ตรวจ -->
  <div class="card mb-3">
    <div class="card-body">
      <div class="row g-3 align-items-end">
        <div class="col-md-6">
          <label class="form-label">หน่วยงาน/เครื่องที่ตรวจ</label>
          <input type="text" name="department" class="form-control" placeholder="เช่น OPD, ER, Ward 3 ฯลฯ" required>
        </div>
        <div class="col-md-3">
          <label class="form-label">วันที่ตรวจ</label>
          <input type="date" name="qc_date" class="form-control" required>
        </div>
      </div>
    </div>
  </div>

  <!-- แถวที่ 2: BGM Serial + Strip Lot + Exp -->
  <div class="card mb-3">
    <div class="card-body">
      <div class="row g-3 align-items-end">
        <div class="col-md-4">
          <label class="form-label">BGM Serial No.</label>
          <input type="text" name="bgm_serial" class="form-control" placeholder="Serial No. เครื่อง" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Strip Lot.</label>
          <input type="text" name="strip_lot" class="form-control" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Strip Exp.</label>
          <input type="date" name="strip_exp" class="form-control" required>
        </div>
      </div>
    </div>
  </div>

  <!-- หัวข้อ Control Level -->
  <h5 class="mt-3 mb-2 text-success fw-bold">Control Level</h5>

  <!-- Control Level 0 -->
  <div class="card mb-2">
    <div class="card-header">
      Control Level 0
    </div>
    <div class="card-body">
      <div class="row g-3 align-items-end">
        <div class="col-md-3">
          <label class="form-label">Control Lot.</label>
          <input type="text" name="ctrl0_lot" class="form-control">
        </div>
        <div class="col-md-3">
          <label class="form-label">Control Exp.</label>
          <input type="date" name="ctrl0_exp" class="form-control">
        </div>
        <div class="col-md-3">
          <label class="form-label">ค่าอ้างอิง (min - max)</label>
          <div class="input-group">
            <input type="number" step="0.01" name="ctrl0_ref_min" class="form-control" placeholder="min">
            <span class="input-group-text">-</span>
            <input type="number" step="0.01" name="ctrl0_ref_max" class="form-control" placeholder="max">
          </div>
        </div>
        <div class="col-md-3">
          <label class="form-label">ผลการทดสอบ (mg/dL)</label>
          <input type="number" step="0.01" name="ctrl0_value" class="form-control">
        </div>
      </div>
    </div>
  </div>

  <!-- Control Level 1 -->
  <div class="card mb-2">
    <div class="card-header">
      Control Level 1
    </div>
    <div class="card-body">
      <div class="row g-3 align-items-end">
        <div class="col-md-3">
          <label class="form-label">Control Lot.</label>
          <input type="text" name="ctrl1_lot" class="form-control">
        </div>
        <div class="col-md-3">
          <label class="form-label">Control Exp.</label>
          <input type="date" name="ctrl1_exp" class="form-control">
        </div>
        <div class="col-md-3">
          <label class="form-label">ค่าอ้างอิง (min - max)</label>
          <div class="input-group">
            <input type="number" step="0.01" name="ctrl1_ref_min" class="form-control" placeholder="min">
            <span class="input-group-text">-</span>
            <input type="number" step="0.01" name="ctrl1_ref_max" class="form-control" placeholder="max">
          </div>
        </div>
        <div class="col-md-3">
          <label class="form-label">ผลการทดสอบ (mg/dL)</label>
          <input type="number" step="0.01" name="ctrl1_value" class="form-control">
        </div>
      </div>
    </div>
  </div>

  <!-- Control Level 2 -->
  <div class="card mb-3">
    <div class="card-header">
      Control Level 2
    </div>
    <div class="card-body">
      <div class="row g-3 align-items-end">
        <div class="col-md-3">
          <label class="form-label">Control Lot.</label>
          <input type="text" name="ctrl2_lot" class="form-control">
        </div>
        <div class="col-md-3">
          <label class="form-label">Control Exp.</label>
          <input type="date" name="ctrl2_exp" class="form-control">
        </div>
        <div class="col-md-3">
          <label class="form-label">ค่าอ้างอิง (min - max)</label>
          <div class="input-group">
            <input type="number" step="0.01" name="ctrl2_ref_min" class="form-control" placeholder="min">
            <span class="input-group-text">-</span>
            <input type="number" step="0.01" name="ctrl2_ref_max" class="form-control" placeholder="max">
          </div>
        </div>
        <div class="col-md-3">
          <label class="form-label">ผลการทดสอบ (mg/dL)</label>
          <input type="number" step="0.01" name="ctrl2_value" class="form-control">
        </div>
      </div>
    </div>
  </div>

  <!-- ปุ่มบันทึก -->
  <div class="text-end">
    <button type="submit" class="btn btn-primary">
      บันทึกผล QC
    </button>
  </div>

</form>
{% endblock %}
